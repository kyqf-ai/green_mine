/* ==================== 兼容性与基础优化 ==================== */
body {
    font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    background: var(--c-bg);
    color: var(--c-txt);
    height: 100vh;
    overflow: hidden;
    transition: background var(--trans-speed), color var(--trans-speed);
}

/* 滚动条深色适配 */
* {
    scrollbar-width: thin;
    scrollbar-color: var(--c-mut) transparent;
}

::-webkit-scrollbar {
    width: 6px;
    height: 6px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb {
    background: #475569;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--c-p);
}

/* ==================== 变量与主题定义 ==================== */
:root {
    --sidebar-w: 320px;
    --header-h: 60px;
    --trans-speed: 0.3s;
}

[data-theme="default"] { --c-p: #0f766e; --c-p-rgb: 15, 118, 110; --c-bg: #f8fafc; --c-sidebar: #fff; --c-card: #fff; --c-txt: #334155; --c-mut: #64748b; --c-bd: #e2e8f0; --c-hov: #f1f5f9; --c-active: #e6fffa; --c-input-bg: #ffffff; }
[data-theme="autumn"] { --c-p: #a0522d; --c-p-rgb: 160, 82, 45; --c-bg: #f5e6d3; --c-sidebar: #fbf6ec; --c-card: #fbf6ec; --c-txt: #4a3b2a; --c-mut: #8b7355; --c-bd: #e6dcc8; --c-hov: #ece2cf; --c-active: #fcefe6; --c-input-bg: #fffbf5; }
[data-theme="cyan"] { --c-p: #0891b2; --c-p-rgb: 8, 145, 178; --c-bg: #ecfeff; --c-sidebar: #fff; --c-card: #fff; --c-txt: #155e75; --c-mut: #6b7280; --c-bd: #cffafe; --c-hov: #e0f2fe; --c-active: #cffafe; --c-input-bg: #f0fdfa; }
[data-theme="teagreen"] { --c-p: #5f9ea0; --c-p-rgb: 95, 158, 160; --c-bg: #e8f5e9; --c-sidebar: #f1f8e9; --c-card: #fff; --c-txt: #2f4f4f; --c-mut: #587979; --c-bd: #b8dcb8; --c-hov: #dcedc8; --c-active: #cffafe; --c-input-bg: #dcedc8; }
[data-theme="warm"] { --c-p: #57534e; --c-p-rgb: 87, 83, 78; --c-bg: #f5f5f4; --c-sidebar: #fafaf9; --c-card: #fff; --c-txt: #292524; --c-mut: #78716c; --c-bd: #e7e5e4; --c-hov: #f5f5f4; --c-active: #e7e5e4; --c-input-bg: #ffffff; }
[data-theme="dark"] { --c-p: #2dd4bf; --c-p-rgb: 45, 212, 191; --c-bg: #0f172a; --c-sidebar: #1e293b; --c-card: #1e293b; --c-txt: #e2e8f0; --c-mut: #94a3b8; --c-bd: #334155; --c-hov: #334155; --c-active: rgba(45, 212, 191, 0.1); --c-input-bg: #0f172a; }

/* ==================== 组件适配 ==================== */
.btn-primary { background: var(--c-p) !important; border-color: var(--c-p) !important; color: #fff; }
.btn-outline-primary { color: var(--c-p) !important; border-color: var(--c-p) !important; }
.btn-outline-primary:hover { background: var(--c-p) !important; color: #fff !important; }
.text-primary { color: var(--c-p) !important; }

/* 解决深色模式下 bg-light 刺眼问题 */
.bg-light { background: var(--c-hov) !important; color: var(--c-txt) !important; }

.border, .border-top, .border-bottom, .border-start, .border-end { border-color: var(--c-bd) !important; }
.card { background: var(--c-card); border-color: var(--c-bd); color: var(--c-txt); transition: background var(--trans-speed); }
.text-muted { color: var(--c-mut) !important; }

/* 表单控件深色适配 */
.form-control, .form-select { background-color: var(--c-input-bg) !important; border-color: var(--c-bd) !important; color: var(--c-txt) !important; }
.form-control:focus, .form-select:focus { border-color: var(--c-p) !important; box-shadow: 0 0 0 0.25rem rgba(var(--c-p-rgb), 0.15) !important; color: var(--c-txt) !important; }

/* 下拉菜单适配 */
.dropdown-menu { background-color: var(--c-card); border-color: var(--c-bd); }
.dropdown-item { color: var(--c-txt); }
.dropdown-item:hover { background-color: var(--c-hov); color: var(--c-p); }
.dropdown-divider { border-top-color: var(--c-bd); }

.card-header-theme { background: var(--c-p) !important; color: #fff !important; }

/* ==================== 布局 ==================== */
#app { display: flex; flex-direction: column; height: 100%; }
.navbar { height: var(--header-h); background: var(--c-card); border-bottom: 1px solid var(--c-bd); flex-shrink: 0; padding: 0 1rem; z-index: 1001; }
.navbar-brand { color: var(--c-p) !important; font-weight: 700; font-size: 1.15rem; letter-spacing: 0.5px; }
.main-wrapper { display: flex; flex: 1; overflow: hidden; position: relative; }
.sidebar { width: var(--sidebar-w); background: var(--c-sidebar); border-right: 1px solid var(--c-bd); display: flex; flex-direction: column; flex-shrink: 0; z-index: 1000; transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
.sidebar-content { flex: 1; overflow-y: auto; padding: 0.5rem 0; }
.app-footer { height: 36px; background: var(--c-card); border-top: 1px solid var(--c-bd); display: flex; align-items: center; justify-content: center; font-size: 0.75rem; color: var(--c-mut); flex-shrink: 0; }

/* ==================== 树形菜单 ==================== */
.tree-item { padding: 0.5rem 0.8rem; cursor: pointer; display: flex; align-items: center; font-size: 0.9rem; border-left: 3px solid transparent; transition: all 0.15s; border-radius: 0 4px 4px 0; margin-right: 8px; }
.tree-item:hover { background: var(--c-hov); }
.tree-item.active { background: var(--c-active); border-left-color: var(--c-p); color: var(--c-p); font-weight: 600; }
.tree-toggle { width: 18px; text-align: center; margin-right: 2px; color: var(--c-mut); transition: transform 0.2s; display: inline-block; }
.tree-toggle.expanded { transform: rotate(90deg); }
.tree-icon-type { width: 20px; text-align: center; margin-right: 6px; }
.tree-code { font-family: "Consolas", "Monaco", monospace; font-size: 0.8rem; margin-right: 8px; color: var(--c-mut); opacity: 0.8; }
.tree-children { display: none; padding-left: 1.1rem; }
.tree-children.show { display: block; }
.status-dot { width: 8px; height: 8px; background: #22c55e; border-radius: 50%; margin-left: auto; box-shadow: 0 0 0 2px var(--c-sidebar); }

/* ==================== 内容区 ==================== */
.content-area { flex: 1; padding: 1.5rem; overflow-y: auto; background-image: radial-gradient(var(--c-bd) 1px, transparent 1px); background-size: 20px 20px; }
.stat-card { border: none; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.03); height: 100%; display: flex; flex-direction: column; justify-content: center; padding: 1.5rem; border-radius: 12px; transition: transform 0.2s; }
.stat-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05); }
.icon-box { width: 48px; height: 48px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; margin-bottom: 1rem; background: rgba(var(--c-p-rgb), 0.1); color: var(--c-p); }
.upload-dropzone { border: 2px dashed var(--c-bd); border-radius: 12px; padding: 2rem; text-align: center; background: var(--c-hov); cursor: pointer; transition: all 0.2s; position: relative; overflow: hidden; }
.upload-dropzone:hover { border-color: var(--c-p); background: rgba(var(--c-p-rgb), 0.05); }
.file-card { background: var(--c-card); border: 1px solid var(--c-bd); border-radius: 8px; padding: 1rem; display: flex; align-items: center; transition: all 0.2s; margin-bottom: 0.75rem; }
.file-card:hover { transform: translateX(3px); border-color: var(--c-p); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
.file-icon-wrapper { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; border-radius: 8px; margin-right: 1rem; flex-shrink: 0; }

@media (max-width: 991px) {
    .sidebar { position: absolute; height: 100%; left: -100%; box-shadow: 10px 0 20px rgba(0, 0, 0, 0.1); }
    .sidebar.show { left: 0; }
    .content-overlay { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.4); z-index: 999; display: none; backdrop-filter: blur(2px); }
    .content-overlay.show { display: block; }
    .content-area { padding: 1rem; background-image: none; }
}

.fade-in { animation: fadeIn 0.3s ease-out forwards; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
